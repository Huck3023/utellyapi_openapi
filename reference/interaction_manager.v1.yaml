openapi: 3.0.0
info:
  title: interaction_manager
  version: '1.0'
  description: Interactions base API
servers:
  - url: 'http://localhost:3000'
paths:
  /interactions:
    parameters: []
    get:
      summary: List all Interactions
      tags: []
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Interaction'
              examples:
                example-1:
                  value:
                    - type: watch
                      cascade_create: false
                      created_at: '2019-08-24T14:15:22Z'
                      target_guid: string
                      context:
                        platform: ios
                        duration: 0
                        price: 0
                        rating: -1
                        session_guid: string
                        portion: 0
        '201':
          description: Created
        '400':
          description: Bad Request
      operationId: get-users-user_id-interactions
    post:
      summary: ''
      operationId: post-users-user_id-interactions
      responses:
        '200':
          description: OK
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Interaction'
            examples:
              example-1:
                value:
                  type: watch
                  cascade_create: false
                  created_at: '2019-08-24T14:15:22Z'
                  target_guid: string
                  context:
                    platform: ios
                    duration: 0
                    price: 0
                    rating: -1
                    session_guid: string
                    portion: 0
components:
  schemas:
    Interaction:
      title: Interaction
      type: object
      x-examples:
        example-1:
          type: watch
          cascade_create: false
          created_at: '2019-08-24T14:15:22Z'
          target_guid: 94d4af44-bb2d-41d8-a44c-8d319d32a23a
          context:
            platform: web
            duration_secs: 0
            value: 0
            rating: 0
            recommendation_guid: 5e987e47-7ed0-4442-a3bb-e3aeacd4840c
            portion: 0
            search_guid: 9dbfe687-e3e0-4991-a8de-bad847ab05ed
            quantity: 0
            user_attributes: {}
            target_attributes: {}
          user_guid: 5a8e692f-59b5-4cc3-954e-33e6104b8782
          target_type: creative_work
      description: 'This model represents the interaction between a user and an object (creative works, people, tags, etc...).'
      properties:
        type:
          anyOf:
            - enum:
                - bookmark
                - rate
                - view
                - watch
                - buy
                - rent
              default: watch
              description: |
                what kind of interaction are we recording between a user and an object
          type: string
        cascade_create:
          $ref: '#/components/schemas/cascade_create_field'
        created_at:
          format: date-time
          type: string
          description: UTC timestamp of the view as ISO8601-1 pattern or UTC epoch time. The default value is the current time.
          readOnly: true
        target_guid:
          type: string
          description: 'guid of the '
          example: 94d4af44-bb2d-41d8-a44c-8d319d32a23a
        context:
          type: object
          description: 'Generalpurpose object to collect info that is very context dependant, esp of the type of interaction we record'
          properties:
            platform:
              type: string
              enum:
                - ios
                - android
                - web
                - chromecast
                - firetv
                - roku
                - ctv_samsung
                - ctv_lg
                - ctv_sony
                - ctv_philips
                - ctv_panasonic
                - ctv_hisense
                - ctv_xiaomi
                - ctv_other
                - stb_other
                - stb_youview
                - stb_virginmedia
                - stv_sky
                - stb_freeview
                - stb_freesat
              description: Which platform did the interaction take place on?
              default: web
            duration_secs:
              type: integer
              minimum: 0
              format: int64
              description: 'How long did the interaction last, in seconds?'
            value:
              type: number
              format: float
              minimum: 0
              description: A value associated with the interaction.
            rating:
              type: number
              multipleOf: 0
              minimum: -1
              maximum: 1
              format: float
              description: A rating associated with the interaction
              example: 0
            recommendation_guid:
              type: string
              description: A guid to tie back the interaction to recommended content
              example: 5e987e47-7ed0-4442-a3bb-e3aeacd4840c
            portion:
              type: number
              format: float
              minimum: 0
              maximum: 1
              default: 0
              description: '% of the target object interacted with. Can be the length of the content watched'
            search_guid:
              type: string
              description: A guid to tie back the interaction to search results
              example: 9dbfe687-e3e0-4991-a8de-bad847ab05ed
            quantity:
              type: number
              format: float
              description: 'quantity of object(s) interacted with. For instance, user bought 2 tickets for a movie.'
            user_attributes:
              type: object
              description: data storage for extra user attributes
            target_attributes:
              type: object
              description: data storage for extra target_object attributes
        user_guid:
          type: string
          example: 5a8e692f-59b5-4cc3-954e-33e6104b8782
        target_type:
          type: string
          enum:
            - creative_work
            - person
            - location
            - tag
            - other
      required:
        - type
        - created_at
        - target_guid
        - user_guid
        - target_type
    cascade_create_field:
      type: boolean
      title: cascade_create_field
      default: false
      description: 'if true, will create the required resources that need to pre-exist for the action to take place'
    content_type_field:
      title: content_type_field
      oneOf:
        - enum:
            - movie
            - series
            - podcast
            - website
          example: movie
      x-examples: {}
      type: string
  securitySchemes:
    Authorization:
      name: Authorization
      type: apiKey
      in: header
security:
  - Authorization: []
